<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô - MASKRIDER SHOP</title>
    <link rel="stylesheet" href="styles.css">
    <script src="auth.js"></script>
</head>
<body>
    <header class="amazon-header">
        <a href="Html.html" class="logo">MASKRIDER SHOP</a>

        <div class="search-bar">
            <select>
                <option>‡∏ó‡∏∏‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</option>
                <option>‡∏≠‡∏¥‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏£‡∏≠‡∏ô‡∏¥‡∏Å‡∏™‡πå</option>
                <option>‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤</option>
                <option>‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠</option>
                <option>‡∏ö‡πâ‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏ß‡∏ô</option>
            </select>
            <input type="text" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤...">
            <button>üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
        </div>

        <div class="header-links">
            <a id="accountLink" href="login.html">üë§ ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô</a>
            <a id="logoutLink" href="#" style="display:none;">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</a>
            <a href="favorites.html">‚ù§Ô∏è ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡∏î</a>
        </div>
    </header>

    <nav>
        <ul class="head-menu">
            <li><a href="Html.html">‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</a></li>
            <li><a href="about.html">‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÄ‡∏£‡∏≤</a></li>
            <li><a href="services.html">‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</a></li>
            <li><a href="contact.html">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤</a></li>
        </ul>
    </nav>

    <main class="auth-page">
        <section class="auth-card">
            <h1 class="auth-title">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</h1>

            <form id="registerForm" class="auth-form">
                <div class="auth-field">
                    <label for="username">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</label>
                    <input id="username" name="username" type="text" autocomplete="username" required>
                </div>

                <div class="auth-field">
                    <label for="password">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</label>
                    <input id="password" name="password" type="password" autocomplete="new-password" required>
                </div>

                <div class="auth-field">
                    <label for="confirm">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</label>
                    <input id="confirm" name="confirm" type="password" autocomplete="new-password" required>
                </div>

                <button class="checkout-btn" type="submit">‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ</button>
                <div id="registerStatus" class="auth-status"></div>
            </form>

            <div class="auth-footer">
                <span>‡∏°‡∏µ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÅ‡∏•‡πâ‡∏ß?</span>
                <a class="auth-link" href="login.html">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</a>
            </div>
        </section>
    </main>

    <script>
        (function () {
            const form = document.getElementById('registerForm');
            const statusEl = document.getElementById('registerStatus');
            if (!form) return;

            function setStatus(message, type) {
                if (!statusEl) return;
                statusEl.textContent = message;
                statusEl.style.color = type === 'success' ? '#2e7d32' : type === 'error' ? '#c62828' : '#333';
            }

            form.addEventListener('submit', function (e) {
                e.preventDefault();
                const fd = new FormData(form);
                const username = String(fd.get('username') || '').trim();
                const password = String(fd.get('password') || '');
                const confirm = String(fd.get('confirm') || '');

                if (password !== confirm) {
                    setStatus('‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô', 'error');
                    return;
                }

                const result = window.auth.register(username, password);
                if (!result.ok) {
                    setStatus(result.message || '‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'error');
                    return;
                }

                window.auth.login(username, password);
                setStatus('‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', 'success');

                const returnUrl = window.auth.getReturnUrl();
                location.href = returnUrl ? returnUrl : 'Html.html';
            });
        })();
    </script>
</body>
</html>
